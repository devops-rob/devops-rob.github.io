<!doctype html><html><head><title>Architecting Vault - Part 3</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/layouts/main.css><link rel=stylesheet href=/css/navigators/navbar.css><link rel=stylesheet href=/css/plyr.css><link rel=stylesheet href=/css/flag-icon.min.css><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600"><link rel=stylesheet href=/fontawesome/css/all.min.css><meta property="og:title" content="Architecting Vault - Part 3"><meta property="og:description" content="Part 3 in a blog series exploring architectural the design decisions of a Vault architect"><meta property="og:type" content="article"><meta property="og:url" content="https://devops-rob.github.io/posts/vault/architecting-vault-part-3/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-07-29T08:06:25+06:00"><meta property="article:modified_time" content="2019-07-29T08:06:25+06:00"><meta name=description content="Part 3 in a blog series exploring architectural the design decisions of a Vault architect"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css><link rel=stylesheet href=/css/layouts/single.css><link rel=stylesheet href=/css/navigators/sidebar.css><link rel=stylesheet href=/css/style.css></head><body data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button onclick=toggleSidebar()>
<span class=navbar-toggler-icon></span></button>
<a class=navbar-brand href=/>DevOps Rob</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button onclick=toggleTOC()>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"></ul></div></div></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts data-filter=all>Posts</a></li><div class=subtree><li><i class="fas fa-plus-circle"></i><a href=/posts/conference-talks/>Conference Talks</a><ul><li><a href=/posts/conference-talks/devops-exchange-london-march-2022/ title="DevOps Exchange London March 2022">DevOps Exchange London March 2022</a></li><li><a href=/posts/conference-talks/hashiconf-eu-2021/ title="HashiConf EU 2021: The Zero Trust Mindset">HashiConf EU 2021: The Zero Trust Mindset</a></li><li><a href=/posts/conference-talks/hashitalks-2020/ title="HashiTalks 2020: Securing RabbitMQ with Vault">HashiTalks 2020: Securing RabbitMQ with Vault</a></li><li><a href=/posts/conference-talks/kafka-summit-eu-2021/ title="Kafka Summit EU 2021: Encrypting Kafka messages at rest to secure applications">Kafka Summit EU 2021: Encrypting Kafka messages at rest to secure applications</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/devops/>DevOps</a><ul><li><a href=/posts/devops/what-is-the-future-of-devops/ title="What is the future of DevOps">What is the future of DevOps</a></li></ul></li><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/vault/>HashiCorp Vault</a><ul class=active><li><a href=/posts/vault/architecting-vault-part-1/ title="Architecting Vault - Part 1">Architecting Vault - Part 1</a></li><li><a href=/posts/vault/architecting-vault-part-2/ title="Architecting Vault - Part 2">Architecting Vault - Part 2</a></li><li><a class=active href=/posts/vault/architecting-vault-part-3/ title="Architecting Vault - Part 3">Architecting Vault - Part 3</a></li><li><a href=/posts/vault/architecting-vault-part-4/ title="Architecting Vault - Part 4">Architecting Vault - Part 4</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/the-devops-lab-videos/>The DevOps Lab (Channel9)</a><ul><li><a href=/posts/the-devops-lab-videos/part1-automating-secrets-management/ title="Automating Secrets Management - Part 1">Automating Secrets Management - Part 1</a></li><li><a href=/posts/the-devops-lab-videos/part2-automating-secrets-management/ title="Automating Secrets Management - Part 2">Automating Secrets Management - Part 2</a></li><li><a href=/posts/the-devops-lab-videos/workload-authentication/ title="Workload authentication">Workload authentication</a></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(https://devops-rob.github.io/images/vault/part3-hero.jpeg)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=/images/authors/hashiconf_huebbfad1edfa8e198fe68a27ac6a615ca_208200_120x120_fit_q75_box.jpg alt="Author Image"><h5 class=author-name>Rob Barnes</h5><p>Monday, July 29, 2019</p></div><div class=title><h1>Architecting Vault - Part 3</h1></div><div class=post-content id=post-content><p>So far in this blog series, we have covered hosting options for Vault deployments and also explored the different options available for Storage backends and some of the considerations needed when making your design decision.</p><p>This post will look at the auth methods that are available for you to enable in your Vault deployment and how to make the right decision as to which option to choose for your use case.</p><h3 id=what-is-an-auth-method>What is an Auth Method?</h3><p>As a secrets management platform, Vault holds sensitive information to which access needs to be carefully managed and controlled. In order to understand how Vault can achieve this, there are two concepts which I will briefly discuss which are authentication and authorisation.</p><h3 id=authentication>Authentication</h3><p>Authentication is the process of assigning an identity to a user, much like what happens when you sign into most modern day applications. It will ask you for a username, which is you telling the application who you are. Next it will ask for a password which is a method of proving that you are who you say you are. Some applications may have an extra layer of security such as multi-factor authentication. Once you have signed in, the application will assign you your identity in the context of the application.</p><h3 id=authorisation>Authorisation</h3><p>Authorisation is the process of managing what resources, files and data that each identity should and shouldn’t have access to. There is a dependancy on authentication to enable authorisation to work effectively. Authentication and authorisation are two halves that make up the same coin to deliver the coin’s value, access control.</p><p>With this context now set out, let’s go back and address the original question, what is an auth method? From Vault’s perspective, an auth method is a way of assigning an identity to a user accessing Vault (authentication).</p><h3 id=which-auth-method-do-i-choose>Which auth method do I choose?</h3><p>Vault provides several different ways to do authentication, some of which are more suitable to some organisations than others. Below is a list of some of the commonly used auth methods available to us to use in our Vault deployment design.</p><ol><li>GitHub</li><li>Okta</li><li>LDAP</li><li>Username and password</li><li>AWS</li><li>Azure</li><li>GCP</li></ol><p>Which auth method you choose will depend on what you use to manage identities for other platforms and applications. For example, I think it’s fair to say that majority of enterprise size organisations would use something like Active Directory to manage user accounts in the organisation. In this example, a lot of time and effort would have already been placed into the design of the directory structure, organisational units and groups. You can all but guarantee that the directory contains user accounts for the entire organisation and security groups have been set up according to the business structure and business logic. In this case, it make the most sense to use the LDAP auth method as most of the structural work is already done for us.</p><p>I want to point out that Vault allows you to enable multiple auth methods in your deployment so that gives you flexibility when choosing which auth methods to enable.</p><p>To demonstrate this, I’ll use a different example use case which is a small tech startup with 1–20 users. These organisations typically would not have an Active Directory in place as it’s more than likely not cost effective for the number of users they have. They do use GitHub to store and manage their source code, which means most of the organisation’s developers would have GitHub accounts which are linked to the organisation’s GitHub account. The organisation may also have a Marketing Director and a Finance & HR Director who both don’t have GitHub accounts for understandable reasons. In this case, it makes the most sense to enable both the GitHub auth method and the username & password auth method.</p><h3 id=application-identities>Application identities</h3><p>For the most part, the methods listed above are geared towards assigning users an identity for vault, but what about assigning identities to applications? Vault offers some auth methods which are better suited this, as listed below:</p><ol><li>AppRole</li><li>JWT / OIDC</li><li>TLS</li><li>Kubernetes</li></ol><p>Depending on the nature of your application, these options should provide effective ways of it authenticating. If your application is made up of micro-services which are orchestrated using Kubernetes, then this will also be a sensible choice of auth method.</p><p>Approle is in my opinion, the most flexible of the above listed auth methods for applications as it allows for multiple differing workflows, which makes it suitable for almost all applications and services, no matter how different they are. You should bare in mind that this level of flexibility can easily inject added complexities into your design if you don’t design the workflows with the wholistic view in mind.</p><h3 id=summary>Summary</h3><p>When choosing which auth methods to enable, you need to understand some of the following things in order to produce a suitable design:</p><p>Who will need to log in to Vault and why?
How is the organisation currently managing identity and user accounts?
What platforms are existing services and applications being hosted on?
How are existing applications currently handling authentication?
What are the future plans on the roadmap for existing applications and services as well as new ones?
The answers to these questions will guide you into choosing the right combination of auth methods. Auth methods can be enabled and disabled at any time so you can evolve your Vault platform as your roadmap moves along. Another thing to consider is if the organisation has or is moving towards a Single Sign On (SSO). If there is already SSO in place or plans to implement it, your choice of auth method should reflect this.</p><p>It’s also worth noting that you may need to re-architect parts of your existing applications to work with some of these auth methods so you will also need to ascertain how much technical debt it will incur and if this debt is acceptable.</p></div><div class="row pl-3 pr-3"><div class="col-md-6 share-buttons"></div><div class="col-md-6 btn-improve-page"><a href=https://github.com/devops-rob/devops-rob.github.io/edit/main/content/posts/vault/architecting-vault-part-3.md title="Improve this page" target=_blank rel=noopener><i class="fas fa-code-branch"></i>
Improve this page</a></div></div><hr><div class="row next-prev-navigator"><div class="col-md-6 previous-article"><a href=/posts/vault/architecting-vault-part-2/ title="Architecting Vault - Part 2" class="btn btn-outline-info"><div><i class="fas fa-chevron-circle-left"></i> Prev</div><div class=next-prev-text>Architecting Vault - Part 2</div></a></div><div class="col-md-6 next-article"><a href=/posts/vault/architecting-vault-part-4/ title="Architecting Vault - Part 4" class="btn btn-outline-info"><div>Next <i class="fas fa-chevron-circle-right"></i></div><div class=next-prev-text>Architecting Vault - Part 4</div></a></div></div><hr></div></div></div><a id=scroll-to-top class=btn><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center pl-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents><ul><li><ul><li><a href=#what-is-an-auth-method>What is an Auth Method?</a></li><li><a href=#authentication>Authentication</a></li><li><a href=#authorisation>Authorisation</a></li><li><a href=#which-auth-method-do-i-choose>Which auth method do I choose?</a></li><li><a href=#application-identities>Application identities</a></li><li><a href=#summary>Summary</a></li></ul></li></ul></nav></div></div></section></div><footer id=footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=https://devops-rob.github.io#about>About</a></li><li class=nav-item><a class=smooth-scroll href=https://devops-rob.github.io#skills>Skills</a></li><li class=nav-item><a class=smooth-scroll href=https://devops-rob.github.io#recent-posts>Recent Posts</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><a href=mailto:iam@devopsrob.com target=_blank rel=noopener><span><i class="fas fa-envelope"></i></span> <span>iam@devopsrob.com</span></a></li></ul></div></div></div><hr><div class=container><div class="row text-left"><div class=col-md-4></a></div><div class="col-md-4 text-center">© 2022 Copyright.</div></div></div></footer><script type=text/javascript src=/js/jquery-3.4.1.min.js></script>
<script type=text/javascript src=/js/popper.min.js></script>
<script type=text/javascript src=/js/bootstrap.min.js></script>
<script type=text/javascript src=/js/navbar.js></script>
<script type=text/javascript src=/js/plyr.js></script>
<script type=text/javascript src=/js/main.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js></script>
<script src=/js/single.js></script>
<script>hljs.initHighlightingOnLoad()</script></body></html>